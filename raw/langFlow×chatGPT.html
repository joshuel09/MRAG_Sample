<!DOCTYPE html>
<html lang="ja" class="dark html-bg-white">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="viewport-extra" content="width=device-width,initial-scale=1,min-width=375" />
 </head>

      <!-- POST CONTENT -->
      <div class="single-page-content" id="js-blog-content">
        <section data-field="body" class="e-content">
        <p>こんにちは、Technology部のジョシュです。</p><p>昨今、生成AIの進化に伴い、AIを組み込んだ「チャットボット」もノーコードで開発することが可能になりました。</p><p>LangChainのような大規模言語モデル（LLM）を扱うフレームワークが、開発プロセスを大幅に効率化してくれるようになりましたが、プログラミングが得意でない方々にとって、数百行に及ぶコードの管理はまだまだ大きな高いハードルですよね。</p><p>そこで有効なのが、 「<strong>Lang Flow</strong>」 というオープンソースのパッケージです。</p><dl class="explain"><dt>Lang Flowとは</dt><dd>LangChainのPythonバージョンをもとに構築されているオープンソースのパッケージ。一行のコードも書くことなく、コンポーネントをドラッグ＆ドロップするだけで、誰でも簡単にAIアプリケーションを組み立てることが可能。</dd></dl><p>本記事では、LangFlowを使って、わずか数分でRAGベースのAIチャットボットのプロトタイプを構築する方法を紹介します。また、構築したアプリケーションをローカルで動かしつつ、最小限のコーディングで、Webウィジット（HTML）へ変換する方法も合わせて探りました。</p><p>ノーコードでのAIチャットボット開発に興味のある方は、ぜひご覧ください。</p><div id="toc_container" class="no_bullets"><p class="toc_title">目次　</p><ul class="toc_list"><li><a href="#RAG">そもそも「RAG」とは？</a></li><li><a href="#RAG-2">RAGのアーキテクチャ</a></li><li><a href="#i">さっそく実験してみた</a><ul><li><a href="#i-2">前提</a></li><li><a href="#LangFlow">LangFlowのインストール方法</a></li><li><a href="#i-3">構築のヒント</a></li></ul></li><li><a href="#LangflowWebHTML">Langflowから作成したフローをWebウィジェット(HTML)に変換してみる</a></li><li><a href="#i-4">まとめ</a></li></ul></div><h2><span id="RAG">そもそも「RAG」とは？</span></h2><p><img loading="lazy" class="alignnone size-full wp-image-643494" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag.png" alt="" width="1326" height="664" /><span class="font-size-small">画像出典：<a class="link" href="https://www.ml6.eu/blogpost/leveraging-llms-on-your-domain-specific-knowledge-base" target="_blank" rel="noopener">https://www.ml6.eu/blogpost/leveraging-llms-on-your-domain-specific-knowledge-base</a></span></p><p><strong>RAG(Retrieval-Augmented Generation)</strong>とは、<strong>自然言語処理（NLP）の技術手法の一つであり、情報検索とテキスト生成を組み合わせた新しいアプローチです。</strong></p><p>具体的には、大量のテキストデータ（PDFやJSONファイルなど）から必要な情報を検索モデルで抽出し、その情報を参考に生成AIが新たなテキストを作り出します。</p><p>RAG技術は、FAQでの自動回答、記事の要約、データベースに基づく質問への対応といった多様な用途に利用されています。とくに、AIチャットボットのような情報の検索とテキストの生成が求められるタスクにおいて、その効果を十分に発揮します。</p><h2><span id="RAG-2">RAGのアーキテクチャ</span></h2><p><img loading="lazy" class="alignnone size-full wp-image-643495" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag2.png" alt="" width="1320" height="690" /><span class="font-size-small">画像出典：<a class="link" href="https://newsletter.nocode.ai/p/guide-retrieval-augmented-generation" target="_blank" rel="noopener">https://newsletter.nocode.ai/p/guide-retrieval-augmented-generation</a></span><br />こちらの画像で説明されているように、RAGのアーキテクチャは通常、以下の8つのステップを含みます。</p><blockquote cite="#"><ol><li><strong>ドキュメントの読み込み</strong>：最初に、文書やデータソースをロードします。</li><li><strong>チャンクへの分割</strong>： 文書を扱いやすいサイズに分割します。</li><li><strong>エンベディングの生成</strong>： 分割した各チャンクをエンベディングを使ってベクトル表現に変換します。</li><li><strong>ベクターデータベースへの保存</strong>： これらのベクトルをベクターデータベースに保存し、効率的に検索できるようにします。</li><li><strong>ユーザーとのインタラクション</strong>： ユーザーからのクエリや入力を受け取り、エンベディングに変換します。</li><li><strong>ベクターデータベースでのセマンティック検索</strong>： ユーザーのクエリに基づいてベクターデータベースでセマンティック検索を行います。</li><li><strong>レスポンスの取得と処理</strong>： 関連するレスポンスを取得し、それを大規模言語モデル（LLM）で処理して回答を生成します。</li><li><strong>ユーザーへの回答の提供</strong>： LLMによって生成された最終的な回答をユーザーに提示します。</li></ol></blockquote><p>以前にPython言語でLangchain、StreamlitとChatGPTモデルを活用してRAGを作成しました。以下の記事で解説していますので、ぜひご覧ください。</p><h2><span id="i">さっそく実験してみた</span></h2><h3><span id="i-2">前提</span></h3><p>LangFlowを始める前に、まず作業環境端末にPythonがインストールされているかを確認しましょう。Pythonのバージョンは3.10以上で、3.12未満である必要があります。</p><h3><span id="LangFlow">LangFlowのインストール方法</span></h3><p>LangFlowのインストールが完了したら、以下のようにターミナルにlangflow runと入力します。</p><pre><code>python3 -m venv langflowsource langflow/bin/activatepip install langflow</code></pre><p>すると、LangFlowを簡単に起動できます。</p><p><img loading="lazy" class="alignnone size-full wp-image-643496" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag3.png" alt="" width="1226" height="466" /></p><p>次に、提供されたURL（例えば、上記の画像で示された http://127.0.0.1:7860）をコピーして、Webブラウザに貼り付けてください。そうすると、すぐにインターフェースが表示されます。</p><p><img loading="lazy" class="alignnone size-full wp-image-643497" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag4.png" alt="" width="3830" height="1884" /></p><p>このページにはプロジェクトがわかりやすく便利に表示されており、ナビゲーションが非常に簡単になっています。</p><p><img loading="lazy" class="alignnone size-full wp-image-643498" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag5.png" alt="" width="1224" height="236" /></p><p>ページ上部のナビゲーションから「New Project」 をクリックしてスタートします。</p><p>このプロジェクトでは、PDFファイルを読み取って、質問に答えるチャットボットを開発しています。前述で説明したRAGのアーキテクチャをもとに、このシステムを構築するために、いくつかの重要な要素を組み合わせる必要があります。</p><p>左側のパネルには、さまざまなコンポーネントが並んでいます。これらの要素をシンプルにドラッグアンドドロップして、チャットボットのフローを構築していきます。</p><ol><li><strong>PDFローダー</strong>：「PyPDFLoader」 から始めて、PDFドキュメントのファイルパスを入力します。</li><li><strong>テキスト分割器</strong>：「RecursiveCharacterTextSplitter」 を使用して、文字のリストによってパラメータ化されたテキストをチャンクに分割します。。</li><li><strong>テキスト埋め込みモデル</strong>： 堅牢でオープンソースの埋め込み用に 「OpenAIEmbeddings」 * を選択して、OpenAPIにあるに シークレットキー を設定します。</li><li><strong>ベクターデータベース</strong>：「FAISS」 を実装して、これらの埋め込みを保存し、ベクター検索を強化します。</li><li><strong>応答生成用LLM</strong>：「Chat OpenAI」 を選び、モデルは有料版の「gpt-4-1106-preview」選択して、OpenAPIにあるにシークレットキーを設定します。「GPT-3.5」と同等の無料版モデルも選択可能です。</li><li><strong>会話メモリ</strong>： 「ConversationBufferMemory」 を有効にしてチャット履歴を保持し、フォローアップの質問に対応します。</li><li><strong>会話取得チェーン</strong>：「ConversationRetrievalChain」 で全てをリンクし、一貫性のある応答システムを形成します。</li></ol><p>各コンポーネントをワークスペースにドラッグアンドドロップし、PDFのパスやLLMモデルなど、必要な設定を構成します。私の設定をコピーすることもできますが、もっと良いアイデアや最適化があれば自分の設定を行うこともできます。</p><p><img loading="lazy" class="alignnone size-full wp-image-643499" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag6.png" alt="" width="2030" height="1299" /></p><p>最後に、上の画像のように要素を組み合わせて、チャットボットのワークフローを確立しましょう。</p><p>すべてが接続されたら、右下隅にある「雷」のボタンを押してフローをコンパイルします。成功すると、各カードのヘッダーにあるインジケーターが緑色に変わり、すべてが正常に動作していることを示します。</p><p>フローのコンパイルが成功した後は、 「チャットボット」 アイコンをクリックして、作成したものをテストしてみましょう。</p><p><img loading="lazy" class="alignnone size-full wp-image-643500" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag7.png" alt="" width="1327" height="1023" /></p><p>この画像からわかるように、このチャットボットは非常にうまく機能しており、コードを一切使わずにPDFファイルを読み取ってその評価をしてくれました！</p><h3><span id="i-3">構築のヒント</span></h3><p>1．フローが完成したら、サイドバーにあるJSONファイルとして保存するか、あとでアクセスしたり編集したりするために、アップロードすることも可能です。</p><p><img loading="lazy" class="alignnone size-full wp-image-643501" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag8.png" alt="" width="629" height="63" /></p><p>2．OpenAIの設定が適さない場合は、Ollamaのようなモデルを利用してRAGパイプラインを構築することも選択可能です。この機能を使用するために必要な要件がインストールされていることを確認してください。</p><h2><span id="LangflowWebHTML">Langflowから作成したフローをWebウィジェット(HTML)に変換してみる</span></h2><p>さきほどの手順でフローの設定が正しく完了したら、アプリケーションに統合します。フローを構築した後、LangFlowでは必要なコードスニペットを提供してくれます。</p><p><img loading="lazy" class="alignnone size-full wp-image-643502" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag9.png" alt="" width="629" height="63" /></p><p>まずは、サイドバーにある「コード」ボタンをクリックします。</p><p><img loading="lazy" class="alignnone size-full wp-image-643503" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag10.png" alt="" width="1034" height="649" /><br />新しいファイル（index.html）を作成するか、お好みに応じて（React、Next、Angular）などのフレームワークも使用できます。コードスニペットメニュー内で 「Chat Widget HTML」 タブに移動し、コードスニペットをコピーしてindex.htmlに貼り付けてください。HTMLのbodyタグ内に配置し、コードにスタイルを追加すればOKです。</p><p>以下は私のindex.html内のコードサンプルです。</p><p>すべての準備が完了したら、ブラウザで動作を確認してみましょう。</p><p><img loading="lazy" class="alignnone size-full wp-image-643504" src="https://liginc.co.jp/wp-content/uploads/2024/05/rag11.png" alt="" width="1169" height="1422" /></p><p>問題なく動作しました！</p><p>ヒント:LangFlowのコードをPythonなどの他の言語に適用し、StreamlitやDjangoなどに統合することも可能です。この柔軟性を活用して、さまざまなアプリケーションでLangFlowを使用してみてください。</p><p>さらにカスタマイズを進めたい方や詳しい情報が必要な方は、<a class="link" href="https://docs.langflow.org/guidelines/chat-widget" target="_blank" rel="noopener">LangFlowの公式ドキュメント</a>をぜひご覧ください。</p><h2><span id="i-4">まとめ</span></h2><p>この記事では、賢いRAGベースのAIチャットボットを開発しました。ノーコードでRAGパイプラインを構築するためにLangFlowを利用して、ChatGPTモデルを活用して埋め込みとLLM処理をおこないました。アプリケーションをローカルでコストなしで開発できますし、AIチャットボットをWebウィジェットに変換することも可能です。</p><p>LangFlowのノーコード方式は、AIアプリケーションの構築とプロトタイピングの方法を変革する可能性があると信じています。ただ、一部のコンポーネントはまだ開発中またはベータ版であり、期待通りに動作しない場合があります。</p><p>また、こういった問題の原因やトラブルシューティングについてのサポート情報がまだまだ不十分です。さらなる改善として、よりカスタマイズを容易にするためにPythonコードを直接提供することも考えられるでしょう。</p><p>全体として、LangFlowは迅速なプロトタイピングに非常に価値のあるツールなので、ぜひ試してみてください！</p><p>また、LIGでは生成AIコンサルティング事業をおこなっています。ぜひお気軽にご相談ください。</p><p><a class="button-style button-strong button-link" href="https://liginc.co.jp/solutions/technology/ai" target="_blank" rel="noopener"><i class="icon-arrowright"></i>LIGの生成AIコンサルティングの詳細を見る</a></p>         
        </section>
      </div>      

<link rel='stylesheet' id='hljstheme-css'  href='https://liginc.co.jp/wp-content/plugins/lig-code-tag/highlight/styles/tomorrow-night.css?ver=1' type='text/css' media='all' />

<script>


</script>


</body>
</html>
